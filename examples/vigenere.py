#!/usr/bin/python

from lantern.modules import vigenere
from lantern.analysis import english_frequency, frequency_to_probability
from lantern.score_functions import ChiSquared

ciphertext = """HNQDLVYOPOKFACCEKYATQNEPPTUKPCVVGBXYLPCZIIZTGORRNETKVILSVOHZUCQWTLAETMVZTEUMEEKANRETRETKVILSVOHRMTGBFRUKVKQGLRKXKUHMPUMUZTJOCILANVECPKGLYKKIFISLPNAYYIAHTOIGPEEOTJFCJYPFNYCXHJAEERRFIRCSRVCETDEBLANYSBIEJSRUAHGOCVZOHDLVOAEUIIKIFISLLVGBAFUDGBAYHTOKHVOIODMTRWJKXWVREOWJOAROHYPMYREKTAAREMLMQVHVKHKWMRTAJKGBLRGXXVYMAGSISDOSRVPSCGSISDVREKIEISRJDIVRWTOOQVMDZMCBXVYTJKRDVSVYJKOEQDLVYKKNWKOIUMVRWTJOCKLAERYJIOTOWDLDCWRLUDGBETOIGFIIAHGIVVHLNKPZREKWMEQUPSSIOIIRSIOIIRWTOOQVMMLLKCXVUEFDSKLAERIIZEZZPRPNHYVKOEHSJKLEPDLKPMGRSNAOTOHLJECPVRJTKYRZBNFOVJAAPNMKUOOCWDPTJSHZKNVCLFDMAGSIRIFSHZAIPWCYLAFNEDUKKNTIVBCLPPJORSIUPTVRIPYECVPRSIMOMDHDGKHZZCQFIIFTQNEPPFQERUHCQWTLAETGEZAAUOGFUDVRMJPSEYSCPTFYIJDHCDMNHNVSXKVIHSXDHKGCEDPSVKOVPTULITHUUOMJJRGGIUPTWZRFABGMELZEKDHFLSPDPZREOOSIMEGVWKORGKXVUEFLCDLOTDLZUKUSQRZMCBXRZSQBHFLSPDPZREVOETOIPQEEKSJYYCKNVLIYLRGNEDUKKNECSHGNSVZIUZPRFGCWIJAHGIVVHLNKPZRECXHKOEPSXYHPRORVKAFYSIVPGXIUAOCGSISDTEWYPNIDLIVUIRXYLPJYRVSIPOPZREJOVFPNVRVFBGJKRRKDKMXJCEKXWRUENOGKYOPSGGBLUOMJZEPDSLAATOJLNEHBSDAHGNEPAOFKCZUCQWTVAEPMMVZIUCSLNHVKFFHRFSWWVUPNXYPSKCMKAHKCMJDHGBIZIENYRXPKPYAVCETISELHGBIVCEPSJZCEPOZVYMGDXYLMPOZVYTCVOVKTQDLVTMCIRVCETRIRYFTYQKOEOKKRPNKURFDYQEECSDCWRBPDVIMENURDLVWHQXICPNGKKRPNVRIPYECVPRSIMOCFBBGDCFBRCCWNLRGKPCHLKUINLVGLIVUSRYSEMEFLESFFQYHRASERSFSWJORNLHWXKVYEFPSIZTGKOKOEDSXJVFOOEKAHCDCFBDKNPVASNSTKORQEKYDETOTILCJOAVKAPNXRZTGVIJZWGFISLEPNSDPNCDIUIYUKHZZTUYVZNNQBIUIYVRIRWAVRIKPCVRIWLWVREKOAFCSDLTJSRXAOVOETOFQERUBSYSPCPNIZYGPLULYKAHQCIWLWCBICPKGNVFWSQPARAETSRKOEFOWVYTVRMJPSQEVNVRNNRFDTJOAFYLFYJKOEGVITARQXEEKTJOWNPTERXYLBGKYKFOHDLVIAWNAVTAMOYJLOHKWVYVKMIRSRGKHPLXKCXZUGYSXYVUVZEPPNIPSIDHCDGFBLFLIUPRVMLVHPKPMKDAUXXIBNDITIVFKDIVYIPQKCBTVYRJHNFISLJANVYJJRKWMEHLUGIVEPNYVVHNFISLJANVYJJRKWMEHLUGIJLEMKJKLRMXSNSEFQIRUDAYYTHLNEWTYIOSRRSSYOIOPSVGMKOOWDWBPNEYPFYWKDLFBTPKXZVNCVMKFWKDLFBTTOPZNIQEWSPAUKRUFOWMECSUUMVZTIPKPJFOWLYZSDCDSDPCDYQSZYQEARNEYKVJFOWWYIKETMLVHTCXHCPEVYYJHNFDVPAOOKOVBSDOPZLVGSXJMOTYYIVWPQSFKYGDAVYEVRITYIOSRRSSAOWZHMCMVZTIPKPDFCTSQVPSVREKVFEEVZVSKDCDFCTSQVPSVREKVFLEHXPNIZIFWLGLCNOAVDLVFSCIEEKTJSRBUOVGLRATJOCCVOMVMBLMAMVZTEKCXYHTQPSLASOKVKPNIISLZOOOXYPNIDLRAYQEAZSLPOZVYFQBKZCEOOJFYICWEYHCMOVRUDVRMJPSOIQRUIHOWKVYQEQRFSVYTKOIUSRUPVKNYRSBWDCFBCCXXJAOREWRSLCPXVYANVAVYECVPRSIMO"""

english_probabilities = frequency_to_probability(english_frequency.unigrams())
decryptions = vigenere.crack(ciphertext, [ChiSquared(english_probabilities)], 30)
print(decryptions.plaintext)
